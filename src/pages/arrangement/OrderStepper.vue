<template>
  <div class="row justify-between items-center no-wrap">
    <div
      v-for="(el, index) in steps"
      :key="index"
      :style="index !== steps.length - 1 ? 'width: 50%' : ''"
    >
      <div
        class="row no-wrap full-height"
        :class="[index !== steps.length - 1 ? 'col' : '', ,]"
      >
        <div
          class="bold header3 row justify-center items-center step"
          :class="[
            index <= currentStep
              ? 'bg-primary text-on-primary'
              : 'bg-backing-color text-on-backing-color unselected-step',
            ,
          ]"
        >
          <CustomIcon
            :color="
              index <= currentStep
                ? `#${$uiSettings.item?.primaryColor.on_color}`
                : `#${$uiSettings.item?.backingColor.on_color}`
            "
            :svg="el.svg"
            :width="el.width"
            :height="el.height"
          />

          <!-- <CIcon
            size="20px"
            :name="el.icon"
            :color="
              index <= currentStep ? 'background-color' : 'on-background-color'
            "
          /> -->
        </div>
        <div
          v-if="index !== steps.length - 1"
          class="devider col-grow bg-backing-color"
          :style="`margin-top: ${$q.screen.lt.md ? '22' : '25'}px;`"
        ></div>
      </div>
    </div>
  </div>
</template>
<script lang="ts" setup>
import CustomIcon from 'src/components/icons/CustomIcon.vue'
import { OrderType } from 'src/models/menu/menuItem/menuRulesForAdding/menuRulesForAdding'
import { OrderStatusType } from 'src/models/order/order'
import { orderRepo } from 'src/models/order/orderRepo'
import { computed } from 'vue'

const currentStep = computed(() => {
  if (
    orderRepo.item?.status === OrderStatusType.CREATED ||
    orderRepo.item?.status === OrderStatusType.VALIDATED ||
    orderRepo.item?.status === OrderStatusType.ACCEPTED
  )
    return 0
  else if (orderRepo.item?.status === OrderStatusType.COOKING) return 1
  else if (orderRepo.item?.status === OrderStatusType.ON_WAY) return 2
  else if (
    orderRepo.item?.status === OrderStatusType.READY ||
    orderRepo.item?.status === OrderStatusType.CLOSED
  )
    return orderRepo.item.type === OrderType.DELIVERY ? 3 : 2
  else return 0
})

// todo кал с svg
const steps = computed(() => {
  const initialSteps = [
    {
      svg: '<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.7915 20.7384L6.23495 16.0472C5.98943 15.7944 5.65643 15.6524 5.3092 15.6524C4.96198 15.6524 4.62898 15.7944 4.38346 16.0472C4.13793 16.3 4 16.6428 4 17.0003C4 17.1773 4.03386 17.3526 4.09966 17.5162C4.16545 17.6797 4.26189 17.8283 4.38346 17.9534L9.87228 23.6046C10.3844 24.1318 11.2117 24.1318 11.7238 23.6046L25.6165 9.30103C25.8621 9.04825 26 8.7054 26 8.34791C26 7.99042 25.8621 7.64758 25.6165 7.39479C25.371 7.14201 25.038 7 24.6908 7C24.3436 7 24.0106 7.14201 23.7651 7.39479L10.7915 20.7384Z" fill="#282424"/></svg>',
      height: '30px',
      width: '30px',
    },
    {
      svg: '<svg width="18" height="23" viewBox="0 0 18 23" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.909 6.54545C14.126 6.54545 14.3341 6.45925 14.4875 6.30581C14.641 6.15237 14.7272 5.94427 14.7272 5.72727V0.818182C14.7272 0.601186 14.641 0.393079 14.4875 0.23964C14.3341 0.086201 14.126 0 13.909 0C13.692 0 13.4839 0.086201 13.3305 0.23964C13.177 0.393079 13.0908 0.601186 13.0908 0.818182V5.72727C13.0908 5.94427 13.177 6.15237 13.3305 6.30581C13.4839 6.45925 13.692 6.54545 13.909 6.54545Z" fill="black"/><path d="M4.09091 0C1.67973 0 0 3.44945 0 6.54545C0 8.59091 0.765 10.1536 2.12073 10.9293L1.69282 20.7753C1.68089 21.051 1.7249 21.3263 1.82219 21.5846C1.91948 21.8429 2.06803 22.0788 2.25891 22.2782C2.44979 22.4776 2.67904 22.6362 2.93286 22.7447C3.18667 22.8531 3.45981 22.909 3.73582 22.9091H4.446C4.72221 22.9093 4.99562 22.8537 5.24972 22.7454C5.50383 22.6371 5.73337 22.4785 5.92451 22.2791C6.11565 22.0797 6.26443 21.8436 6.36187 21.5852C6.4593 21.3267 6.50339 21.0512 6.49145 20.7753L6.06354 10.9293C7.41682 10.1536 8.18182 8.59091 8.18182 6.54545C8.18182 3.44945 6.50209 0 4.09091 0ZM4.93036 9.65863C4.76929 9.71961 4.63156 9.82986 4.53681 9.97369C4.44205 10.1175 4.3951 10.2876 4.40264 10.4596L4.85427 20.8465C4.85659 20.9016 4.84772 20.9567 4.82821 21.0083C4.80869 21.0599 4.77892 21.1071 4.7407 21.1469C4.70248 21.1867 4.65659 21.2184 4.60581 21.24C4.55502 21.2616 4.50038 21.2728 4.44518 21.2727H3.73582C3.68062 21.2728 3.62598 21.2616 3.57519 21.24C3.52441 21.2184 3.47852 21.1867 3.4403 21.1469C3.40208 21.1071 3.37231 21.0599 3.35279 21.0083C3.33328 20.9567 3.32441 20.9016 3.32673 20.8465L3.77836 10.4596C3.7859 10.2876 3.73895 10.1175 3.64419 9.97369C3.54944 9.82986 3.41171 9.71961 3.25064 9.65863C2.20909 9.26509 1.63636 8.15891 1.63636 6.54545C1.63636 3.94773 3.00927 1.63636 4.09091 1.63636C5.17254 1.63636 6.54545 3.94773 6.54545 6.54545C6.54545 8.15891 5.97273 9.26509 4.93036 9.65863Z" fill="black"/><path d="M17.182 0C16.965 0 16.7569 0.086201 16.6035 0.23964C16.45 0.393079 16.3638 0.601186 16.3638 0.818182V6.54545C16.3651 7.05076 16.2091 7.54394 15.9175 7.95662C15.6259 8.36931 15.2132 8.68105 14.7364 8.84863C14.5744 8.90626 14.4349 9.01403 14.3383 9.1563C14.2416 9.29856 14.1928 9.46793 14.1989 9.63982C14.1989 9.648 14.6726 20.8489 14.6726 20.8489C14.675 20.9041 14.6661 20.9591 14.6466 21.0107C14.627 21.0624 14.5973 21.1095 14.5591 21.1493C14.5208 21.1892 14.475 21.2209 14.4242 21.2425C14.3734 21.2641 14.3187 21.2752 14.2635 21.2752H13.5534C13.4982 21.2752 13.4435 21.2641 13.3927 21.2425C13.3419 21.2209 13.2961 21.1892 13.2578 21.1493C13.2196 21.1095 13.1899 21.0624 13.1703 21.0107C13.1508 20.9591 13.142 20.9041 13.1443 20.8489C13.1443 20.8489 13.6196 9.64636 13.6188 9.63982C13.6235 9.46772 13.5732 9.2986 13.4752 9.15705C13.3772 9.01549 13.2367 8.90889 13.0739 8.85273C12.7365 8.73402 12.4293 8.5427 12.1739 8.29227C11.7121 7.82834 11.4534 7.20003 11.4547 6.54545V0.818182C11.4547 0.601186 11.3685 0.393079 11.2151 0.23964C11.0616 0.086201 10.8535 0 10.6365 0C10.4195 0 10.2114 0.086201 10.058 0.23964C9.90456 0.393079 9.81836 0.601186 9.81836 0.818182V6.54545C9.81925 7.63358 10.2521 8.67682 11.0219 9.44591C11.3045 9.72 11.6243 9.95301 11.9718 10.1381L11.5112 20.7745C11.4991 21.0503 11.5431 21.3257 11.6403 21.5841C11.7375 21.8424 11.8861 22.0785 12.077 22.2779C12.2678 22.4774 12.4971 22.6361 12.751 22.7446C13.0049 22.8531 13.2781 22.909 13.5542 22.9091H14.2644C14.5406 22.9093 14.814 22.8537 15.0681 22.7454C15.3222 22.6371 15.5517 22.4785 15.7429 22.2791C15.934 22.0797 16.0828 21.8436 16.1802 21.5852C16.2777 21.3267 16.3217 21.0512 16.3098 20.7753L15.8467 10.1455C16.4981 9.79671 17.0425 9.27758 17.4218 8.64353C17.801 8.00947 18.001 7.28429 18.0002 6.54545V0.818182C18.0002 0.601186 17.914 0.393079 17.7605 0.23964C17.6071 0.086201 17.399 0 17.182 0Z" fill="black"/></svg>',
      height: '23px',
      width: '18px',
    },
    {
      svg: '<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.2662 8.82816C14.4059 8.33463 13.4329 8.04961 12.4315 7.99785C11.4301 7.9461 10.4307 8.12917 9.52 8.53117C9.38787 8.58941 9.27593 8.68267 9.19741 8.79992C9.11889 8.91716 9.07708 9.05349 9.07692 9.19277V16.5288C10.3171 16.0512 11.656 15.8552 12.9885 15.9562C14.3211 16.0572 15.6111 16.4524 16.7574 17.1108L17.2337 17.3853C18.0365 17.8462 18.9478 18.1059 19.8832 18.1402C20.8186 18.1745 21.7479 17.9823 22.5852 17.5815C22.6869 17.533 22.7725 17.4583 22.8322 17.3658C22.8919 17.2732 22.9234 17.1666 22.9231 17.0578V9.61572C21.7065 10.0446 20.405 10.2068 19.1144 10.0902C17.8238 9.97363 16.5769 9.58133 15.4655 8.94218L15.2662 8.82816ZM23.5143 19.3608C22.3645 19.911 21.0884 20.1747 19.804 20.1274C18.5196 20.0801 17.2684 19.7234 16.1662 19.0903L15.6885 18.8159C14.7959 18.3032 13.7891 18.0006 12.7507 17.9331C11.7123 17.8655 10.6719 18.035 9.71523 18.4274L9.07692 18.6899V23.0056C9.07692 23.2693 8.96751 23.5223 8.77276 23.7087C8.57802 23.8952 8.31388 24 8.03846 24C7.76304 24 7.49891 23.8952 7.30416 23.7087C7.10941 23.5223 7 23.2693 7 23.0056V9.19277C7 8.13208 7.64385 7.16951 8.64769 6.72534C9.86602 6.18722 11.2032 5.94217 12.5429 6.01149C13.8826 6.08081 15.1844 6.4624 16.3351 7.1231L16.5345 7.23713C17.4559 7.76689 18.4987 8.07284 19.5719 8.1283C20.6451 8.18376 21.7162 7.98706 22.6918 7.55533L23.5268 7.18674C23.685 7.1169 23.859 7.08629 24.0328 7.09774C24.2066 7.10919 24.3746 7.16233 24.5213 7.25226C24.6681 7.34219 24.7888 7.46602 24.8725 7.61236C24.9561 7.7587 25 7.92283 25 8.08965V17.0578C25 18.0323 24.424 18.9246 23.5143 19.3608Z" fill="black"/></svg>',
      height: '30px',
      width: '30px',
    },
  ]
  if (orderRepo.item?.type === OrderType.DELIVERY) {
    initialSteps.splice(2, 0, {
      svg: '<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_6002_13271)"><path d="M22.6575 17.8361C20.5723 17.8361 18.876 19.5325 18.876 21.6176C18.876 23.7028 20.5723 25.3992 22.6575 25.3992C24.743 25.3992 26.439 23.7028 26.439 21.6176C26.439 19.5325 24.7427 17.8361 22.6575 17.8361ZM22.6575 23.5084C21.6148 23.5084 20.7667 22.6604 20.7667 21.6176C20.7667 20.5749 21.6148 19.7269 22.6575 19.7269C23.7002 19.7269 24.5483 20.5749 24.5483 21.6176C24.5483 22.6604 23.7002 23.5084 22.6575 23.5084Z" fill="black"/><path d="M9.73758 17.8361C7.6524 17.8361 5.95605 19.5325 5.95605 21.6176C5.95605 23.7028 7.6524 25.3992 9.73758 25.3992C11.8228 25.3992 13.5191 23.7028 13.5191 21.6176C13.5191 19.5325 11.8228 17.8361 9.73758 17.8361ZM9.73758 23.5084C8.69484 23.5084 7.84682 22.6604 7.84682 21.6176C7.84682 20.5749 8.69484 19.7269 9.73758 19.7269C10.78 19.7269 11.6283 20.5749 11.6283 21.6176C11.6283 22.6604 10.7803 23.5084 9.73758 23.5084Z" fill="black"/><path d="M25.2042 7.01221C25.0435 6.69299 24.7167 6.4916 24.3594 6.4916H19.3804V8.38236H23.7764L26.3506 13.5025L28.0404 12.6529L25.2042 7.01221Z" fill="black"/><path d="M19.8213 20.7038H12.668V22.5946H19.8213V20.7038Z" fill="black"/><path d="M6.90133 20.7038H3.62406C3.10187 20.7038 2.67871 21.127 2.67871 21.6492C2.67871 22.1714 3.10193 22.5945 3.62406 22.5945H6.90139C7.42357 22.5945 7.84674 22.1713 7.84674 21.6492C7.84674 21.127 7.42352 20.7038 6.90133 20.7038Z" fill="black"/><path d="M29.8016 14.9244L27.9421 12.5294C27.7634 12.2987 27.4877 12.1638 27.1955 12.1638H20.3257V5.54619C20.3257 5.024 19.9025 4.60084 19.3804 4.60084H3.62406C3.10187 4.60084 2.67871 5.02406 2.67871 5.54619C2.67871 6.06832 3.10193 6.49154 3.62406 6.49154H18.435V13.1092C18.435 13.6314 18.8582 14.0545 19.3803 14.0545H26.7326L28.1093 15.828V20.7037H25.4938C24.9716 20.7037 24.5484 21.1269 24.5484 21.649C24.5484 22.1712 24.9716 22.5944 25.4938 22.5944H29.0547C29.5769 22.5944 30 22.1712 30.0001 21.649V15.5042C30.0001 15.2943 29.9301 15.0901 29.8016 14.9244Z" fill="black"/><path d="M6.83807 15.9139H2.4893C1.96711 15.9139 1.54395 16.3371 1.54395 16.8592C1.54395 17.3814 1.96717 17.8046 2.4893 17.8046H6.83801C7.3602 17.8046 7.78336 17.3814 7.78336 16.8592C7.78342 16.3371 7.36019 15.9139 6.83807 15.9139Z" fill="black"/><path d="M9.0126 12.1954H0.945352C0.423223 12.1954 0 12.6186 0 13.1408C0 13.6629 0.423223 14.0861 0.945352 14.0861H9.0126C9.53479 14.0861 9.95795 13.6629 9.95795 13.1408C9.95795 12.6186 9.53479 12.1954 9.0126 12.1954Z" fill="black"/><path d="M10.5565 8.47688H2.4893C1.96711 8.47688 1.54395 8.9001 1.54395 9.42223C1.54395 9.94441 1.96717 10.3676 2.4893 10.3676H10.5565C11.0787 10.3676 11.5019 9.94436 11.5019 9.42223C11.502 8.9001 11.0787 8.47688 10.5565 8.47688Z" fill="black"/></g><defs><clipPath id="clip0_6002_13271"><rect width="30" height="30" fill="white"/></clipPath></defs></svg>',
      height: '30px',
      width: '30px',
    })
  }
  return initialSteps
})
</script>

<style lang="scss" scoped>
.step {
  width: 50px;
  height: 50px;
  border-radius: 50%;
}

.devider {
  height: 4px !important;
}

body.screen--xs,
body.screen--sm {
  .step {
    width: 44px;
    height: 44px;
    border-radius: 50%;
  }
}
</style>
